<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - CineBooking</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="admin-layout">
      <!-- Sidebar -->
      <aside class="admin-sidebar" id="sidebar">
        <div class="sidebar-header">
          <a href="/" class="logo">
            <i class="fas fa-film"></i>
            <span>CineBooking</span>
          </a>
          <span class="admin-badge">Admin</span>
        </div>
        <nav class="sidebar-nav">
          <a href="#dashboard" class="nav-item active" data-section="dashboard">
            <i class="fas fa-chart-line"></i>
            <span>Dashboard</span>
          </a>
          <a href="#movies" class="nav-item" data-section="movies">
            <i class="fas fa-film"></i>
            <span>Quản lý phim</span>
          </a>
          <a href="#cinemas" class="nav-item" data-section="cinemas">
            <i class="fas fa-building"></i>
            <span>Quản lý rạp</span>
          </a>
          <a href="#rooms" class="nav-item" data-section="rooms">
            <i class="fas fa-door-open"></i>
            <span>Quản lý phòng</span>
          </a>
          <a href="#showtimes" class="nav-item" data-section="showtimes">
            <i class="fas fa-calendar-alt"></i>
            <span>Suất chiếu</span>
          </a>
          <a href="#bookings" class="nav-item" data-section="bookings">
            <i class="fas fa-ticket-alt"></i>
            <span>Đặt vé</span>
          </a>
          <a href="#users" class="nav-item" data-section="users">
            <i class="fas fa-users"></i>
            <span>Người dùng</span>
          </a>
        </nav>
        <div class="sidebar-footer">
          <a href="/" class="nav-item">
            <i class="fas fa-home"></i>
            <span>Về trang chủ</span>
          </a>
          <button class="nav-item" id="logoutBtn">
            <i class="fas fa-sign-out-alt"></i>
            <span>Đăng xuất</span>
          </button>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="admin-main">
        <!-- Header -->
        <header class="admin-header">
          <button class="menu-toggle" id="menuToggle">
            <i class="fas fa-bars"></i>
          </button>
          <div class="header-search">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Tìm kiếm..." id="globalSearch" />
          </div>
          <div class="header-user">
            <span id="adminName">Admin</span>
            <i class="fas fa-user-circle"></i>
          </div>
        </header>

        <!-- Content Area -->
        <div class="admin-content">
          <!-- Dashboard Section -->
          <section id="dashboardSection" class="content-section active">
            <h1>Dashboard</h1>

            <!-- Stats Cards -->
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon" style="background: #e74c3c">
                  <i class="fas fa-ticket-alt"></i>
                </div>
                <div class="stat-info">
                  <h3 id="totalBookings">0</h3>
                  <p>Đặt vé hôm nay</p>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon" style="background: #2ecc71">
                  <i class="fas fa-money-bill-wave"></i>
                </div>
                <div class="stat-info">
                  <h3 id="todayRevenue">0 ₫</h3>
                  <p>Doanh thu hôm nay</p>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon" style="background: #3498db">
                  <i class="fas fa-film"></i>
                </div>
                <div class="stat-info">
                  <h3 id="totalMovies">0</h3>
                  <p>Phim đang chiếu</p>
                </div>
              </div>
              <div class="stat-card">
                <div class="stat-icon" style="background: #9b59b6">
                  <i class="fas fa-users"></i>
                </div>
                <div class="stat-info">
                  <h3 id="totalUsers">0</h3>
                  <p>Người dùng</p>
                </div>
              </div>
            </div>

            <!-- Revenue Chart -->
            <div class="dashboard-card">
              <div class="card-header">
                <h3><i class="fas fa-chart-line"></i> Thống kê doanh thu</h3>
                <select id="revenueRange" class="form-select">
                  <option value="7">7 ngày qua</option>
                  <option value="30" selected>30 ngày qua</option>
                  <option value="90">90 ngày qua</option>
                </select>
              </div>
              <div class="card-body" style="padding: 20px">
                <canvas id="revenueChart"></canvas>
              </div>
            </div>

            <!-- Recent Bookings -->
            <div class="dashboard-card" style="margin-top: 24px">
              <div class="card-header">
                <h3><i class="fas fa-ticket-alt"></i> Đặt vé gần đây</h3>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="admin-table">
                    <thead>
                      <tr>
                        <th>Mã đặt vé</th>
                        <th>Khách hàng</th>
                        <th>Phim</th>
                        <th>Suất chiếu</th>
                        <th>Tổng tiền</th>
                        <th>Trạng thái</th>
                      </tr>
                    </thead>
                    <tbody id="recentBookingsTable">
                      <tr>
                        <td colspan="6" class="text-center">Đang tải...</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>

          <!-- Movies Section -->
          <section id="moviesSection" class="content-section">
            <div class="section-header">
              <h1>Quản lý phim</h1>
              <button class="btn btn-primary" onclick="openMovieModal()">
                <i class="fas fa-plus"></i> Thêm phim
              </button>
            </div>
            <div class="table-responsive">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Poster</th>
                    <th>Tên phim</th>
                    <th>Thể loại</th>
                    <th>Thời lượng</th>
                    <th>Trạng thái</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="moviesTable">
                  <tr>
                    <td colspan="7" class="text-center">Đang tải...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Cinemas Section -->
          <section id="cinemasSection" class="content-section">
            <div class="section-header">
              <h1>Quản lý rạp</h1>
              <button class="btn btn-primary" onclick="openCinemaModal()">
                <i class="fas fa-plus"></i> Thêm rạp
              </button>
            </div>
            <div class="table-responsive">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Tên rạp</th>
                    <th>Địa chỉ</th>
                    <th>Số phòng</th>
                    <th>Trạng thái</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="cinemasTable">
                  <tr>
                    <td colspan="6" class="text-center">Đang tải...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Rooms Section -->
          <section id="roomsSection" class="content-section">
            <div class="section-header">
              <h1>Quản lý phòng chiếu</h1>
              <button class="btn btn-primary" onclick="openRoomModal()">
                <i class="fas fa-plus"></i> Thêm phòng
              </button>
            </div>
            <div class="filter-group">
              <select id="roomCinemaFilter">
                <option value="">Tất cả rạp</option>
              </select>
            </div>
            <div class="table-responsive">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Tên phòng</th>
                    <th>Rạp</th>
                    <th>Số ghế</th>
                    <th>Loại phòng</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="roomsTable">
                  <tr>
                    <td colspan="6" class="text-center">Đang tải...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Showtimes Section -->
          <section id="showtimesSection" class="content-section">
            <div class="section-header">
              <h1>Quản lý suất chiếu</h1>
              <button class="btn btn-primary" onclick="openShowtimeModal()">
                <i class="fas fa-plus"></i> Thêm suất chiếu
              </button>
            </div>
            <div class="filter-group">
              <select id="showtimeCinemaFilter">
                <option value="">Tất cả rạp</option>
              </select>
              <select id="showtimeMovieFilter">
                <option value="">Tất cả phim</option>
              </select>
              <input type="date" id="showtimeDateFilter" />
            </div>
            <div class="table-responsive">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Phim</th>
                    <th>Rạp - Phòng</th>
                    <th>Thời gian</th>
                    <th>Giá vé</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="showtimesTable">
                  <tr>
                    <td colspan="6" class="text-center">Đang tải...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Bookings Section -->
          <section id="bookingsSection" class="content-section">
            <div class="section-header">
              <h1>Quản lý đặt vé</h1>
            </div>
            <div class="filter-group">
              <select id="bookingStatusFilter" class="form-select">
                <option value="">Tất cả trạng thái</option>
                <option value="pending">Chờ thanh toán</option>
                <option value="paid">Đã thanh toán</option>
                <option value="cancelled">Đã hủy</option>
              </select>
              <input type="date" id="bookingDateFilter" class="form-control" />
            </div>
            <div class="table-responsive">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>Mã đặt vé</th>
                    <th>Khách hàng</th>
                    <th>Phim</th>
                    <th>Rạp</th>
                    <th>Suất chiếu</th>
                    <th>Tổng tiền</th>
                    <th>Trạng thái</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="bookingsTable">
                  <tr>
                    <td colspan="8" class="text-center">Đang tải...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>

          <!-- Users Section -->
          <section id="usersSection" class="content-section">
            <div class="section-header">
              <h1>Quản lý người dùng</h1>
            </div>
            <div class="table-responsive">
              <table class="admin-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Họ tên</th>
                    <th>Email</th>
                    <th>Số điện thoại</th>
                    <th>Vai trò</th>
                    <th>Ngày đăng ký</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="usersTable">
                  <tr>
                    <td colspan="7" class="text-center">Đang tải...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </section>
        </div>
      </main>
    </div>

    <!-- Movie Modal -->
    <div class="modal" id="movieModal">
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h2 id="movieModalTitle">Thêm phim mới</h2>
          <button class="modal-close" onclick="closeModal('movieModal')">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="movieForm">
            <input type="hidden" id="movieId" />
            <div class="form-row">
              <div class="form-group">
                <label for="movieTitle">Tên phim *</label>
                <input type="text" id="movieTitle" required />
              </div>
              <div class="form-group">
                <label for="movieGenre">Thể loại *</label>
                <input
                  type="text"
                  id="movieGenre"
                  required
                  placeholder="VD: Hành động, Phiêu lưu"
                />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="movieDuration">Thời lượng (phút) *</label>
                <input type="number" id="movieDuration" required min="1" />
              </div>
              <div class="form-group">
                <label for="movieReleaseDate">Ngày khởi chiếu *</label>
                <input type="date" id="movieReleaseDate" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="movieDirector">Đạo diễn</label>
                <input type="text" id="movieDirector" />
              </div>
              <div class="form-group">
                <label for="movieRating">Phân loại</label>
                <select id="movieRating">
                  <option value="P">P - Phổ biến</option>
                  <option value="C13">C13 - Cấm trẻ em dưới 13</option>
                  <option value="C16">C16 - Cấm trẻ em dưới 16</option>
                  <option value="C18">C18 - Cấm trẻ em dưới 18</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="movieCast">Diễn viên</label>
              <input
                type="text"
                id="movieCast"
                placeholder="VD: Tom Cruise, Emma Watson"
              />
            </div>
            <div class="form-group">
              <label for="moviePoster">URL Poster</label>
              <input type="url" id="moviePoster" placeholder="https://..." />
            </div>
            <div class="form-group">
              <label for="movieTrailer">URL Trailer</label>
              <input
                type="url"
                id="movieTrailer"
                placeholder="https://youtube.com/..."
              />
            </div>
            <div class="form-group">
              <label for="movieDescription">Mô tả</label>
              <textarea id="movieDescription" rows="4"></textarea>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="movieStatus">Trạng thái</label>
                <select id="movieStatus">
                  <option value="now_showing">Đang chiếu</option>
                  <option value="coming_soon">Sắp chiếu</option>
                  <option value="ended">Đã kết thúc</option>
                </select>
              </div>
            </div>
            <div class="form-actions">
              <button
                type="button"
                class="btn btn-outline"
                onclick="closeModal('movieModal')"
              >
                Hủy
              </button>
              <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Cinema Modal -->
    <div class="modal" id="cinemaModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="cinemaModalTitle">Thêm rạp mới</h2>
          <button class="modal-close" onclick="closeModal('cinemaModal')">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="cinemaForm">
            <input type="hidden" id="cinemaId" />
            <div class="form-group">
              <label for="cinemaName">Tên rạp *</label>
              <input type="text" id="cinemaName" required />
            </div>
            <div class="form-group">
              <label for="cinemaAddress">Địa chỉ *</label>
              <input type="text" id="cinemaAddress" required />
            </div>
            <div class="form-group">
              <label for="cinemaCity">Thành phố *</label>
              <input type="text" id="cinemaCity" required />
            </div>
            <div class="form-group">
              <label for="cinemaPhone">Số điện thoại</label>
              <input type="tel" id="cinemaPhone" />
            </div>
            <div class="form-actions">
              <button
                type="button"
                class="btn btn-outline"
                onclick="closeModal('cinemaModal')"
              >
                Hủy
              </button>
              <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Room Modal -->
    <div class="modal" id="roomModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="roomModalTitle">Thêm phòng chiếu</h2>
          <button class="modal-close" onclick="closeModal('roomModal')">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="roomForm">
            <input type="hidden" id="roomId" />
            <div class="form-group">
              <label for="roomCinema">Rạp *</label>
              <select id="roomCinema" required>
                <option value="">Chọn rạp</option>
              </select>
            </div>
            <div class="form-group">
              <label for="roomName">Tên phòng *</label>
              <input
                type="text"
                id="roomName"
                required
                placeholder="VD: Phòng 1"
              />
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="roomRows">Số hàng ghế *</label>
                <input
                  type="number"
                  id="roomRows"
                  required
                  min="1"
                  max="26"
                  value="10"
                />
              </div>
              <div class="form-group">
                <label for="roomSeatsPerRow">Ghế mỗi hàng *</label>
                <input
                  type="number"
                  id="roomSeatsPerRow"
                  required
                  min="1"
                  max="30"
                  value="12"
                />
              </div>
            </div>
            <div class="form-group">
              <label for="roomType">Loại phòng</label>
              <select id="roomType">
                <option value="2D">2D</option>
                <option value="3D">3D</option>
                <option value="IMAX">IMAX</option>
                <option value="4DX">4DX</option>
              </select>
            </div>
            <div class="form-actions">
              <button
                type="button"
                class="btn btn-outline"
                onclick="closeModal('roomModal')"
              >
                Hủy
              </button>
              <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Showtime Modal -->
    <div class="modal" id="showtimeModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="showtimeModalTitle">Thêm suất chiếu</h2>
          <button class="modal-close" onclick="closeModal('showtimeModal')">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="showtimeForm">
            <input type="hidden" id="showtimeId" />
            <div class="form-group">
              <label for="showtimeMovie">Phim *</label>
              <select id="showtimeMovie" required>
                <option value="">Chọn phim</option>
              </select>
            </div>
            <div class="form-group">
              <label for="showtimeCinema">Rạp *</label>
              <select id="showtimeCinema" required>
                <option value="">Chọn rạp</option>
              </select>
            </div>
            <div class="form-group">
              <label for="showtimeRoom">Phòng chiếu *</label>
              <select id="showtimeRoom" required>
                <option value="">Chọn phòng</option>
              </select>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="showtimeDate">Ngày chiếu *</label>
                <input type="date" id="showtimeDate" required />
              </div>
              <div class="form-group">
                <label for="showtimeTime">Giờ chiếu *</label>
                <input type="time" id="showtimeTime" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="showtimeBasePrice">Giá vé thường *</label>
                <input
                  type="number"
                  id="showtimeBasePrice"
                  required
                  min="0"
                  value="75000"
                />
              </div>
              <div class="form-group">
                <label for="showtimeVipPrice">Giá vé VIP *</label>
                <input
                  type="number"
                  id="showtimeVipPrice"
                  required
                  min="0"
                  value="100000"
                />
              </div>
            </div>
            <div class="form-actions">
              <button
                type="button"
                class="btn btn-outline"
                onclick="closeModal('showtimeModal')"
              >
                Hủy
              </button>
              <button type="submit" class="btn btn-primary">Lưu</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/admin.js"></script>
  </body>
</html>
